<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>JRuby Library: SvmToolkit</title>
    <link rel="stylesheet" type="text/css" href="style.css" media="screen" />
  </head>
  <body>
    <div id="header">
      <h1>JRuby Library: SvmToolkit</h1>
    </div>
    <div id="content">
      <div id="right">

  <p>
  This JRuby library is a wrapper around a Java implementation of 
  <a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/">libsvm</a>.
  </p>
  <p>
  Features:
  <ol>
    <li>Ruby interface to create problem sets and models.</li>
    <li>Evaluate models using different performance measures, such as accuracy, geometric mean, precision and recall.</li>
    <li>Built-in grid search to select an RBF model.</li>
    <li>Contour plot of grid-search output.</li>
    <li>Fully graphical demonstration program.</li>
  </ol>
  </p>
        
        <h2>Installation</h2>

        <p>SvmToolkit is implemented in and requires 
        <a href="http://jruby.org"</a>JRuby</a>.
      </p>

      <p>Install through rubygems:
      <tt>jruby -S gem install svm_toolkit</tt>
      </p>

        <h2>Demo Program</h2>
        <p>
  When installed through rubygems, the program <tt>svm-demo</tt> is placed in
  the jruby path.  Running <tt>svm-demo</tt> opens a simple graphical frame,
  allowing the user to place instances, select a kernel type and parameters,
  visualise the decision boundary and highlight the support vectors.  (This
  demo program is based on the libsvm demo applet, but reimplemented in jruby.)
</p>
        <p>
        <center><img src="demo.jpg" height="300" alt="Demonstration program of libsvm"/></center>
        </p>
        <h2>Example Script</h2>
        <p>
<pre><tt><i><font color="#9A1900"># Example using svm_toolkit to classify letters,</font></i>
<i><font color="#9A1900"># using UCI's letter-recognition example.</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># This example illustrates use of built-in grid search to find </font></i>
<i><font color="#9A1900"># the best model, using cross-validation on the number </font></i>
<i><font color="#9A1900"># of errors.  Displays a contour map of search results.</font></i>
<i><font color="#9A1900">#</font></i>
<i><font color="#9A1900"># Written by Peter Lane, 2011.</font></i>

<b><font color="#000080">require</font></b> <font color="#FF0000">"svm_toolkit"</font>
<b><font color="#0000FF">include</font></b> SvmToolkit

<i><font color="#9A1900"># load letter-recognition data</font></i>

<i><font color="#9A1900"># -- given list of strings, first is label, rest are numbers of features</font></i>
<b><font color="#0000FF">def</font></b> make_instance strings
  <font color="#990000">[</font>strings<font color="#990000">.</font>first<font color="#990000">.</font>codepoints<font color="#990000">.</font>first <font color="#990000">-</font> <font color="#993399">65</font><font color="#990000">,</font> strings<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">..-</font><font color="#993399">1</font><font color="#990000">].</font>collect<font color="#FF0000">{</font><font color="#990000">|</font>s<font color="#990000">|</font> s<font color="#990000">.</font>to_i <font color="#990000">/</font> <font color="#993399">15.0</font><font color="#FF0000">}</font><font color="#990000">]</font>
<b><font color="#0000FF">end</font></b>

<b><font color="#0000FF">def</font></b> read_data filename
  data <font color="#990000">=</font> <font color="#990000">[]</font>
  IO<font color="#990000">.</font>foreach<font color="#990000">(</font>filename<font color="#990000">)</font> <b><font color="#0000FF">do</font></b> <font color="#990000">|</font>line<font color="#990000">|</font>
    data <font color="#990000">&lt;&lt;</font> make_instance<font color="#990000">(</font>line<font color="#990000">.</font>split<font color="#990000">(</font><font color="#FF0000">","</font><font color="#990000">))</font>
  <b><font color="#0000FF">end</font></b>

  <b><font color="#0000FF">return</font></b> data
<b><font color="#0000FF">end</font></b>

<b><font color="#0000FF">def</font></b> make_problem instances
  Problem<font color="#990000">.</font>from_array<font color="#990000">(</font>
    instances<font color="#990000">.</font>collect<font color="#FF0000">{</font><font color="#990000">|</font>i<font color="#990000">|</font> i<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">]</font><font color="#FF0000">}</font><font color="#990000">,</font> 
    instances<font color="#990000">.</font>collect<font color="#FF0000">{</font><font color="#990000">|</font>i<font color="#990000">|</font> i<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font><font color="#FF0000">}</font>
  <font color="#990000">)</font>
<b><font color="#0000FF">end</font></b>

Dataset <font color="#990000">=</font> read_data <font color="#FF0000">"letter-recognition.data"</font>
puts <font color="#FF0000">"Read #{Dataset.size} items"</font>
TrainingData <font color="#990000">=</font> make_problem Dataset<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">...</font><font color="#993399">200</font><font color="#990000">]</font> <i><font color="#9A1900"># for speed, only train on 200 instances</font></i>
CrossSet <font color="#990000">=</font> make_problem Dataset<font color="#990000">[</font><font color="#993399">2000</font><font color="#990000">...</font><font color="#993399">3000</font><font color="#990000">]</font>
TestSet <font color="#990000">=</font> make_problem Dataset<font color="#990000">[</font><font color="#993399">3000</font><font color="#990000">..-</font><font color="#993399">1</font><font color="#990000">]</font>

Costs <font color="#990000">=</font> <font color="#990000">[-</font><font color="#993399">5</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">3</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">3</font><font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">,</font> <font color="#993399">8</font><font color="#990000">,</font> <font color="#993399">10</font><font color="#990000">,</font> <font color="#993399">13</font><font color="#990000">,</font> <font color="#993399">15</font><font color="#990000">].</font>collect <font color="#FF0000">{</font><font color="#990000">|</font>n<font color="#990000">|</font> <font color="#993399">2</font><font color="#990000">**</font>n<font color="#FF0000">}</font>
Gammas <font color="#990000">=</font> <font color="#990000">[-</font><font color="#993399">15</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">12</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">8</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">5</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">3</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">3</font><font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">,</font> <font color="#993399">7</font><font color="#990000">,</font> <font color="#993399">9</font><font color="#990000">].</font>collect <font color="#FF0000">{</font><font color="#990000">|</font>n<font color="#990000">|</font> <font color="#993399">2</font><font color="#990000">**</font>n<font color="#FF0000">}</font>

best_model <font color="#990000">=</font> Svm<font color="#990000">.</font>cross_validation_search<font color="#990000">(</font>TrainingData<font color="#990000">,</font> CrossSet<font color="#990000">,</font> Costs<font color="#990000">,</font> Gammas<font color="#990000">,</font> <font color="#990000">:</font>show_plot <font color="#990000">=&gt;</font> <b><font color="#0000FF">true</font></b><font color="#990000">)</font>

puts <font color="#FF0000">"Test set has #{best_model.evaluate_dataset(TestSet, :evaluator =&gt; Evaluator::GeometricMean)}"</font>
best_model<font color="#990000">.</font>save <font color="#FF0000">"best.dat"</font>
</tt></pre>
        </p>
      </div>

      <div id="left">

        <div class="box">
          <h2>Links:</h2>
          <ul>
            <li><a href="http://jruby.org">JRuby</a></li>
            <li><a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/">libsvm</a></li>
          </ul>
        </div>

        <div class="box">
          <h2>Download:</h2>
          <ul>
            <li><a href="https://rubygems.org/gems/svm_toolkit">Rubygems</a> to install</li>
            <li><a href="http://github.com/petercrlane/svm_toolkit">Source</a> on Github</li>
            <li><a href="https://github.com/downloads/petercrlane/svm_toolkit/svm-demo.jar">SVM Demo</a>
          </ul>
        </div>

        <div class="box">
          <h2>About</h2>
          <p>
          This library was written by <a href="https://github.com/petercrlane">Peter Lane</a>.
          </p>
          <p>
          Released under the <a href="http://www.gnu.org/copyleft/gpl.html">GPL</a>.
          </p>
        </div>

      </div>
    </div>
  </body>
</html>
